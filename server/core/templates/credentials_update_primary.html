<hr class="my-4" />
<h4>Alternative Authentication Methods</h4>

(% if matches!(primary_state, CUCredState::Modifiable) %)
    (% match primary %)
        (% when Some(CredentialDetail { uuid, type_ }) %)
            <h6><b>Password</b></h6>
            <p>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticPassword">
                    Change Password
                </button>
            </p>
            <h6><b>Time-based One Time Password (TOTP)</b></h6>
            <p>TOTPs are 6 digit codes generated on-demand as a second authentication factor.</p>
            <p>
                <TotpModalApp token={ token.clone() } cb={ cb.clone() }/>
            </p>
            <br/>
            <p>
                <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#staticDeletePrimaryCred">
                    Delete Alternative Credentials
                </button>
            </p>
        (% when Some(CredentialDetail { uuid, type_:  kanidm_proto::internal::CredentialDetailType::PasswordMfa(totp_set, _security_key_labels, _backup_codes_remaining)}) %)
            <h6> <b>Password</b> </h6>
            <p>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticPassword">
                    Change Password
                </button>
            </p>
            <br/>
            <h6> <b>Time-based One Time Password (TOTP)</b></h6>
            <p>TOTPs are 6 digit codes generated on-demand as a second authentication factor."}</p>
            { for totp_set.iter()
            .map(|detail| html! { <TotpRemoveComp token={ token.clone() } label={ detail.clone() } cb={ cb.clone() } /> })
            }

            <p>
                <TotpModalApp token={ token.clone() } cb={ cb.clone() }/>
            </p>
            <br/>
            <br/>
            <p>
                <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#staticDeletePrimaryCred">
                    Delete Alternative Credentials
                </button>
            </p>
        (% when Some(CredentialDetail { uuid, type_: kanidm_proto::internal::CredentialDetailType::GeneratedPassword }) %)
            <h6><b>Password</b></h6>
            <p>In order to set up alternative authentication methods, you must delete the generated password.</p>
            <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#staticDeletePrimaryCred">
                Delete Generated Password
            </button>
        (% when Some(CredentialDetail { uuid, type_: kanidm_proto::internal::CredentialDetailType::Passkey(_) }) %)
            <p>Webauthn Only - Will migrate to passkeys in a future update</p>
            <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#staticDeletePrimaryCred">
                Delete Alternative Credentials
            </button>
        (% when None %)
            <button type="button" class="btn btn-warning" hx-post="/ui/reset/add_password" hx-target="#credentialUpdateDynamicSection" hx-on::after-request="setupInteractivePwdFormListeners()">
                Add Password
            </button>
    (% endmatch %)
(% else if matches!(primary_state, CUCredState::DeleteOnly) %)
    <p>
        <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#staticDeletePrimaryCred">
            Delete Legacy Credentials
        </button>
    </p>
(% endif %)


<!--let alt_auth_method_warning = match primary_state {-->
<!--CUCredState::Modifiable => {-->
<!--html! {-->
<!--<>-->
<!--<p>If possible, passkeys should be used instead, as they are phishing and exploit resistant.</p>-->
<!--</>-->
<!--}-->
<!--}-->
<!--CUCredState::DeleteOnly => {-->
<!--html! {-->
<!--<>-->
<!--<p>If possible, passkeys should be used instead, as they are phishing and exploit resistant.</p>-->
<!--<p>Account policy prevents you modifying these credentials, but you may remove them.</p>-->
<!--</>-->
<!--}-->
<!--}-->
<!--CUCredState::AccessDeny => {-->
<!--html! {-->
<!--<>-->
<!--<p>You do not have access to modify these credentials.</p>-->
<!--</>-->
<!--}-->
<!--}-->
<!--CUCredState::PolicyDeny => {-->
<!--html! {-->
<!--<>-->
<!--<p>Account policy prevents you from setting these credentials</p>-->
<!--</>-->
<!--}-->
<!--}-->
<!--};-->